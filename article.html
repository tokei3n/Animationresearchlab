<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>記事詳細 | アニメーション研究ラボ</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900 font-sans leading-relaxed">

  <div class="max-w-4xl mx-auto mt-12 bg-white p-6 rounded shadow">
    <div id="article-container">
      <p class="text-gray-500">読み込み中...</p>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCddiuCk4CPQ7nOw6IAd4hAhnNV9n1IaI8",
      authDomain: "anime-lab-ff8bc.firebaseapp.com",
      projectId: "anime-lab-ff8bc"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // クエリパラメータから記事IDを取得
    const urlParams = new URLSearchParams(window.location.search);
    const articleId = urlParams.get("id");

    const container = document.getElementById("article-container");

    if (articleId) {
      db.collection("news").doc(articleId).get().then(doc => {
        if (doc.exists) {
          const data = doc.data();
          const createdAt = data.createdAt?.toDate().toLocaleString("ja-JP") || "日時不明";

          container.innerHTML = `
            <h1 class="text-3xl font-bold text-blue-700 mb-4">${data.title}</h1>
            <p class="text-sm text-gray-500 mb-6">${createdAt}</p>
            ${data.imageUrl ? `<div class="mb-6"><img src="${data.imageUrl}" alt="記事画像" class="rounded shadow-md mx-auto max-w-full max-h-[500px] object-cover" /></div>` : ""}
            <div class="text-lg whitespace-pre-wrap leading-relaxed text-gray-700">${data.content}</div>
            <div class="mt-8">
              <a href="news.html" class="text-blue-600 hover:underline">&larr; ニュース一覧に戻る</a>
            </div>
          `;
        } else {
          container.innerHTML = "<p class='text-red-600'>記事が見つかりませんでした。</p>";
        }
      }).catch(error => {
        console.error("取得エラー:", error);
        container.innerHTML = "<p class='text-red-600'>エラーが発生しました。</p>";
      });
    } else {
      container.innerHTML = "<p class='text-red-600'>記事IDが指定されていません。</p>";
    }
  </script>
</body>
</html>
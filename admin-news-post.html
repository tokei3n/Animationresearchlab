<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCddiuCk4CPQ7nOw6IAd4hAhnNV9n1IaI8",
    authDomain: "anime-lab-ff8bc.firebaseapp.com",
    projectId: "anime-lab-ff8bc",
  };

  const ADMIN_UID = "eJaCdhC1n2bpSLmG2UcBlOrhiPf2"; // ğŸ”‘ ã‚ãªãŸã®UIDã«ç½®ãæ›ãˆã‚‹

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  auth.onAuthStateChanged(user => {
    if (user && user.uid === ADMIN_UID) {
      document.getElementById("news-form").classList.remove("hidden");
    } else {
      document.getElementById("auth-warning").classList.remove("hidden");
    }
  });

  document.getElementById("news-form").addEventListener("submit", async (e) => {
    e.preventDefault();

    const user = auth.currentUser;
    if (!user || user.uid !== ADMIN_UID) {
      alert("ç®¡ç†è€…ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚");
      return;
    }

    const title = document.getElementById("title").value.trim();
    const content = document.getElementById("content").value.trim();

    if (!title || !content) {
      alert("ã‚¿ã‚¤ãƒˆãƒ«ã¨æœ¬æ–‡ã¯å¿…é ˆã§ã™ã€‚");
      return;
    }

    try {
      await db.collection("news").add({
        title: title,
        content: content,
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        authorUid: user.uid,
      });

      document.getElementById("success-msg").classList.remove("hidden");
      document.getElementById("news-form").reset();
    } catch (error) {
      console.error("æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:", error);
      alert("æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ: " + error.message);
    }
  });
</script>